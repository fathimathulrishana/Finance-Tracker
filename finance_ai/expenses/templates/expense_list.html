{% extends 'base.html' %}
{% block title %}Expenses | Finance Tracker{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h2 class="mb-1"><i class="bi bi-receipt"></i> Expenses</h2>
    <p class="text-muted mb-0">Track and manage all your expenses in one place.</p>
  </div>
  <a class="btn btn-primary fw-600" href="/expenses/add/"><i class="bi bi-plus-circle"></i> Add Expense</a>
</div>

<div class="card mb-4">
  <div class="card-body">
    <form method="get" class="row g-3 align-items-end">
      <div class="col-md-4">
        <label class="form-label fw-600">Filter by Month</label>
        {{ form.month }}
      </div>
      <div class="col-md-auto">
        <button class="btn btn-primary" type="submit"><i class="bi bi-funnel"></i> Filter</button>
        <a class="btn btn-outline-secondary" href="/expenses/"><i class="bi bi-arrow-clockwise"></i> Clear</a>
      </div>
    </form>
  </div>
</div>

<div class="card">
  <div class="card-header bg-white border-bottom">
    <h5 class="mb-0"><i class="bi bi-list-ul"></i> Expense Records</h5>
  </div>
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th>Date</th>
            <th>Category</th>
            <th class="text-end">Amount</th>
            <th>Description</th>
            <th class="text-end">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for e in expenses %}
          <tr>
            <td><small class="text-muted">{{ e.date }}</small></td>
            <td>
              <span class="badge {% if e.category == 'Food' %}bg-danger{% elif e.category == 'Travel' %}bg-info{% elif e.category == 'Shopping' %}bg-warning text-dark{% elif e.category == 'Bills' %}bg-danger{% else %}bg-secondary{% endif %}">
                <i class="bi bi-{% if e.category == 'Food' %}cup-hot{% elif e.category == 'Travel' %}car-front{% elif e.category == 'Shopping' %}bag{% elif e.category == 'Bills' %}credit-card{% else %}tag{% endif %}"></i>
                {{ e.category }}
              </span>
            </td>
            <td class="text-end fw-600">${{ e.amount|floatformat:2 }}</td>
            <td><small>{{ e.description|truncatewords:10 }}</small></td>
            <td class="text-end">
              <a class="btn btn-sm btn-outline-primary" href="/expenses/{{ e.id }}/edit/" title="Edit"><i class="bi bi-pencil"></i></a>
              <form action="/expenses/{{ e.id }}/delete/" method="post" class="d-inline" title="Delete">
                {% csrf_token %}
                <button class="btn btn-sm btn-outline-danger" onclick="return confirm('Are you sure you want to delete this expense?')" type="submit"><i class="bi bi-trash"></i></button>
              </form>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5" class="text-center py-5">
              <i class="bi bi-inbox" style="font-size: 3rem; color: #ccc;"></i>
              <p class="text-muted mt-3">No expenses found. <a href="/expenses/add/">Add your first expense</a></p>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
